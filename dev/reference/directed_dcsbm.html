<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a directed degree corrected stochastic blockmodel object — directed_dcsbm • fastRG</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a directed degree corrected stochastic blockmodel object — directed_dcsbm" />
<meta property="og:description" content="To specify a degree-corrected stochastic blockmodel, you must specify
the degree-heterogeneity parameters (via n_in or theta_in, and
n_out or theta_out), the mixing matrix
(via k_in and k_out, or B), and the relative block
probabilities (optional, via p_in and pi_out).
We provide sane defaults for most of these
options to enable rapid exploration, or you can invest the effort
for more control over the model parameters. We strongly recommend
setting the expected_in_degree, expected_out_degree,
or expected_density argument
to avoid large memory allocations associated with
sampling large, dense graphs." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastRG</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RoheLab/fastRG/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a directed degree corrected stochastic blockmodel object</h1>
    <small class="dont-index">Source: <a href='https://github.com/RoheLab/fastRG/blob/master/R/directed_dcsbm.R'><code>R/directed_dcsbm.R</code></a></small>
    <div class="hidden name"><code>directed_dcsbm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>To specify a degree-corrected stochastic blockmodel, you must specify
the degree-heterogeneity parameters (via <code>n_in</code> or <code>theta_in</code>, and
<code>n_out</code> or <code>theta_out</code>), the mixing matrix
(via <code>k_in</code> and <code>k_out</code>, or <code>B</code>), and the relative block
probabilities (optional, via <code>p_in</code> and <code>pi_out</code>).
We provide sane defaults for most of these
options to enable rapid exploration, or you can invest the effort
for more control over the model parameters. We <strong>strongly recommend</strong>
setting the <code>expected_in_degree</code>, <code>expected_out_degree</code>,
or <code>expected_density</code> argument
to avoid large memory allocations associated with
sampling large, dense graphs.</p>
    </div>

    <pre class="usage"><span class='fu'>directed_dcsbm</span><span class='op'>(</span>
  n <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta_in <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta_out <span class='op'>=</span> <span class='cn'>NULL</span>,
  k_in <span class='op'>=</span> <span class='cn'>NULL</span>,
  k_out <span class='op'>=</span> <span class='cn'>NULL</span>,
  B <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  pi_in <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>k_in</span>, <span class='va'>k_in</span><span class='op'>)</span>,
  pi_out <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>k_out</span>, <span class='va'>k_out</span><span class='op'>)</span>,
  sort_nodes <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>(degree heterogeneity) The number of nodes in the blockmodel.
Use when you don't want to specify the degree-heterogeneity
parameters <code>theta_in</code> and <code>theta_out</code> by hand. When <code>n</code> is specified,
<code>theta_in</code> and <code>theta_out</code> are randomly generated from
a <code>LogNormal(2, 1)</code> distribution.
This is subject to change, and may not be reproducible.
<code>n</code> defaults to <code>NULL</code>. You must specify either <code>n</code>
or <code>theta_in</code> and <code>theta_out</code> together, but not both.</p></td>
    </tr>
    <tr>
      <th>theta_in</th>
      <td><p>(degree heterogeneity) A numeric vector
explicitly specifying the degree heterogeneity
parameters. This implicitly determines the number of nodes
in the resulting graph, i.e. it will have <code><a href='https://rdrr.io/r/base/length.html'>length(theta_in)</a></code> nodes.
Must be positive. Setting to a vector of ones recovers
a stochastic blockmodel without degree correction.
Defaults to <code>NULL</code>. You must specify either <code>n</code>
or <code>theta_in</code> and <code>theta_out</code> together, but not both.</p></td>
    </tr>
    <tr>
      <th>theta_out</th>
      <td><p>(degree heterogeneity) A numeric vector
explicitly specifying the degree heterogeneity
parameters. This implicitly determines the number of nodes
in the resulting graph, i.e. it will have <code><a href='https://rdrr.io/r/base/length.html'>length(theta)</a></code> nodes.
Must be positive. Setting to a vector of ones recovers
a stochastic blockmodel without degree correction.
Defaults to <code>NULL</code>. You must specify either <code>n</code>
or <code>theta_in</code> and <code>theta_out</code> together, but not both.</p></td>
    </tr>
    <tr>
      <th>k_in</th>
      <td><p>(mixing matrix) The number of blocks in the blockmodel.
Use when you don't want to specify the mixing-matrix by hand.
When <code>k_in</code> is specified, the elements of <code>B</code> are drawn
randomly from a <code><a href='https://rdrr.io/r/stats/Uniform.html'>Uniform(0, 1)</a></code> distribution.
This is subject to change, and may not be reproducible.
<code>k_in</code> defaults to <code>NULL</code>. You must specify either <code>k_in</code> and
<code>k_out</code> together, or <code>B</code>, but not both.</p></td>
    </tr>
    <tr>
      <th>k_out</th>
      <td><p>(mixing matrix) The number of blocks in the blockmodel.
Use when you don't want to specify the mixing-matrix by hand.
When <code>k_out</code> is specified, the elements of <code>B</code> are drawn
randomly from a <code><a href='https://rdrr.io/r/stats/Uniform.html'>Uniform(0, 1)</a></code> distribution.
This is subject to change, and may not be reproducible.
<code>k_out</code> defaults to <code>NULL</code>. You must specify either <code>k_in</code> and
<code>k_out</code> together, or <code>B</code>, but not both.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>(mixing matrix) A <code>k_in</code> by <code>k_out</code> matrix of block connection
probabilities. The probability that a node in block <code>i</code> connects
to a node in community <code>j</code> is <code><a href='https://rdrr.io/r/stats/Poisson.html'>Poisson(B[i, j])</a></code>.
<code>matrix</code> and <code>Matrix</code> objects are both acceptable.
Defaults to <code>NULL</code>. You must specify either <code>k_in</code> and
<code>k_out</code> together, or <code>B</code>, but not both.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='directed_factor_model.html'>directed_factor_model</a></code></p><dl>
    <dt><code>expected_in_degree</code></dt><dd><p>If specified, the desired expected in degree
of the graph. Specifying <code>expected_in_degree</code> simply rescales <code>S</code>
to achieve this. Defaults to <code>NULL</code>. Specify only one of
<code>expected_in_degree</code>, <code>expected_out_degree</code>, and <code>expected_density</code>.</p></dd>
    <dt><code>expected_out_degree</code></dt><dd><p>If specified, the desired expected out degree
of the graph. Specifying <code>expected_out_degree</code> simply rescales <code>S</code>
to achieve this. Defaults to <code>NULL</code>. Specify only one of
<code>expected_in_degree</code>, <code>expected_out_degree</code>, and <code>expected_density</code>.</p></dd>
    <dt><code>expected_density</code></dt><dd><p>If specified, the desired expected density
of the graph. Specifying <code>expected_density</code> simply rescales <code>S</code>
to achieve this. Defaults to <code>NULL</code>. Specify only one of
<code>expected_in_degree</code>, <code>expected_out_degree</code>, and <code>expected_density</code>.</p></dd>
  
</dl></td>
    </tr>
    <tr>
      <th>pi_in</th>
      <td><p>(relative block probabilities) Relative block
probabilities. Must be positive, but do not need to sum
to one, as they will be normalized internally.
Must match the rows of <code>B</code>, or <code>k_in</code>. Defaults to
<code><a href='https://rdrr.io/r/base/rep.html'>rep(1 / k_in, k_in)</a></code>, or a balanced incoming blocks.</p></td>
    </tr>
    <tr>
      <th>pi_out</th>
      <td><p>(relative block probabilities) Relative block
probabilities. Must be positive, but do not need to sum
to one, as they will be normalized internally.
Must match the columns of <code>B</code>, or <code>k_out</code>. Defaults to
<code><a href='https://rdrr.io/r/base/rep.html'>rep(1 / k_out, k_out)</a></code>, or a balanced outgoing blocks.</p></td>
    </tr>
    <tr>
      <th>sort_nodes</th>
      <td><p>Logical indicating whether or not to sort the nodes
so that they are grouped by block. Useful for plotting.
Defaults to <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>directed_dcsbm</code> S3 object, a subclass of the
<code><a href='directed_factor_model.html'>directed_factor_model()</a></code> with the following additional
fields:</p><ul>
<li><p><code>theta_in</code>: A numeric vector of incoming community
degree-heterogeneity parameters.</p></li>
<li><p><code>theta_out</code>: A numeric vector of outgoing community
degree-heterogeneity parameters.</p></li>
<li><p><code>z_in</code>: The incoming community memberships of each node,
as a <code><a href='https://rdrr.io/r/base/factor.html'>factor()</a></code>. The factor will have <code>k_in</code> levels,
where <code>k_in</code> is the number of incoming
communities in the stochastic blockmodel. There will not
always necessarily be observed nodes in each community.</p></li>
<li><p><code>z_out</code>: The outgoing community memberships of each node,
as a <code><a href='https://rdrr.io/r/base/factor.html'>factor()</a></code>. The factor will have <code>k_out</code> levels,
where <code>k_out</code> is the number of outgoing
communities in the stochastic blockmodel. There will not
always necessarily be observed nodes in each community.</p></li>
<li><p><code>pi_in</code>: Sampling probabilities for each incoming
community.</p></li>
<li><p><code>pi_out</code>: Sampling probabilities for each outgoing
community.</p></li>
<li><p><code>sorted</code>: Logical indicating where nodes are arranged by
block (and additionally by degree heterogeneity parameter)
within each block.</p></li>
</ul>

    <h2 class="hasAnchor" id="generative-model"><a class="anchor" href="#generative-model"></a>Generative Model</h2>

    <p>There are two levels of randomness in a directed degree-corrected
stochastic blockmodel. First, we randomly chose a incoming
block membership and an outgoing block membership
for each node in the blockmodel. This is
handled by <code>directed_dcsbm()</code>. Then, given these block memberships,
we randomly sample edges between nodes. This second
operation is handled by <code><a href='sample_edgelist.directed_erdos_renyi.html'>sample_edgelist()</a></code>,
<code><a href='sample_sparse.directed_erdos_renyi.html'>sample_sparse()</a></code>, <code><a href='sample_igraph.directed_erdos_renyi.html'>sample_igraph()</a></code> and
<code><a href='sample_tidygraph.directed_erdos_renyi.html'>sample_tidygraph()</a></code>, depending on your desired
graph representation.</p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Block memberships</h3>


<p>Let \(x\) represent the incoming block membership of a node
and \(y\) represent the outgoing block membership of a node.
To generate \(x\) we sample from a categorical
distribution with parameter \(\pi_in\).
To generate \(y\) we sample from a categorical
distribution with parameter \(\pi_out\).
Block memberships are independent across nodes. Incoming and outgoing
block memberships of the same node are also independent.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Degree heterogeneity</h3>


<p>In addition to block membership, the DCSBM also
nodes to have different propensities for incoming and
outgoing edge formation.
We represent the propensity to form incoming edges for a
given node by a positive number \(\theta_in\).
We represent the propensity to form outgoing edges for a
given node by a positive number \(\theta_out\).
Typically the \(\theta_in\) (and \(theta_out\)) across all nodes are
constrained to sum to one for identifiability purposes,
but this doesn't really matter during sampling.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Edge formulation</h3>


<p>Once we know the block memberships \(x\) and \(y\)
and the degree  heterogeneity parameters \(\theta_in\) and
\(\theta_out\), we need one more
ingredient, which is the baseline intensity of connections
between nodes in block <code>i</code> and block <code>j</code>. Then each edge forms
indepedently according to a Poisson distribution with
parameters</p>
<p>$$
  \lambda = \theta_in * B[x, y] * \theta_out.
$$</p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other stochastic block models: 
<code><a href='dcsbm.html'>dcsbm</a>()</code>,
<code><a href='planted_partition.html'>planted_partition</a>()</code>,
<code><a href='sbm.html'>sbm</a>()</code></p>
<p>Other directed graphs: 
<code><a href='directed_erdos_renyi.html'>directed_erdos_renyi</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>27</span><span class='op'>)</span>

<span class='va'>dcsbm</span> <span class='op'>&lt;-</span> <span class='fu'>directed_dcsbm</span><span class='op'>(</span>
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  k_in <span class='op'>=</span> <span class='fl'>5</span>,
  k_out <span class='op'>=</span> <span class='fl'>8</span>,
  expected_density <span class='op'>=</span> <span class='fl'>0.01</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Generating random degree heterogeneity parameters `theta_in` from a LogNormal(2, 1) distribution. This distribution may change in the future. Explicitly set `theta_in` for reproducible results.</span></div><div class='output co'>#&gt; <span class='message'>Generating random mixing matrix `B` with independent Uniform(0, 1) entries. This distribution may change in the future. Explicitly set `B` for reproducible results.</span></div><div class='input'>
<span class='va'>dcsbm</span>
</div><div class='output co'>#&gt; Directed Degree-Corrected Stochastic Blockmodel
#&gt; -----------------------------------------------
#&gt; 
#&gt; Nodes (n): 1000 (arranged by block)
#&gt; Incoming Blocks (k_in): 5
#&gt; Outgoing Blocks (k_out): 8
#&gt; 
#&gt; Traditional DCSBM parameterization:
#&gt; 
#&gt; Block memberships (z_in): 1000 [factor] 
#&gt; Block memberships (z_out): 1000 [factor] 
#&gt; Degree heterogeneity (theta_in): 1000 [numeric] 
#&gt; Degree heterogeneity (theta_out): 1000 [numeric] 
#&gt; Block probabilities (pi_in): 5 [numeric] 
#&gt; Block probabilities (pi_out): 8 [numeric] 
#&gt; 
#&gt; Factor model parameterization:
#&gt; 
#&gt; X: 1000 x 5 [dgCMatrix] 
#&gt; S: 5 x 8 [dgeMatrix] 
#&gt; Y: 1000 x 8 [dgCMatrix] 
#&gt; 
#&gt; Expected edges: 10000
#&gt; Expected in degree: 10
#&gt; Expected out degree: 10
#&gt; Expected density: 0.01</div><div class='input'>
<span class='va'>population_svd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/svds.html'>svds</a></span><span class='op'>(</span><span class='va'>dcsbm</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex Hayes, Karl Rohe, Jun Tao, Xintian Han, Norbert Binkiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


