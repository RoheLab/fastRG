---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# fastRG

<!-- badges: start -->
[![Codecov test coverage](https://codecov.io/gh/RoheLab/fastRG/branch/master/graph/badge.svg)](https://codecov.io/gh/RoheLab/fastRG?branch=master)
[![R build status](https://github.com/RoheLab/fastRG/workflows/R-CMD-check/badge.svg)](https://github.com/RoheLab/fastRG/actions)
<!-- badges: end -->

`fastRG` quickly samples a broad class of network models known as generalized random product graphs. In particular, for matrices `X`, `S` and `Y`, `fastRG` samples a matrix `A` with expectation `X S Y^T` where individual entries are Poisson distributed. We recommend that you think of `A` as the adjacency matrix for a graph (or a multi-graph). Crucially, the sampling is `O(m)`, where `m` is the number of the edges in graph. Other algorithms are `O(n^2)`, where `n` is the number of nodes in the network. For additional details, see the [paper](https://arxiv.org/abs/1703.02998).

## Installation

`fastRG` is not yet on CRAN. You can install the development version
with:

``` r
# install.package("devtools")
devtools::install_github("RoheLab/fastRG")
```

## Example Usage

`fastRG` takes an object oriented approach to simulation. First


also--factor model

considerably faster than `igraph` at sampling random dot product graphs and SBMs. is this true?

igraph: SBM sampling

 * Time complexity: O(|V|+|E|+K^2), where |V| is the number of
 * vertices, |E| is the number of edges, and K is the number of
 * groups.
 
  * Time complexity: O(n*n*m), where n is the number of vertices,
 * and m is the length of the latent vectors.

The easiest way to use `fastRG` is to use wrapper functions that sample from popular graph models. For example, to sample from an Erdos-Renyi graph `n = 1,000,000` nodes and expected degree of five, we can use the `erdos_renyi()` function.

We *strongly* advise that you always set `avg_deg`, as it is easy to request very large and dense graphs without this scaling.

```{r}
library(fastRG)

er <- erdos_renyi(n = 10^6, p = 1 / n)
sample_edgelist(er, avg_deg = 2)
expected_edges(er)
```

By default we always get a `Matrix::sparseMatrix()`, but we can also ask for the graph as an edgelist as well.

```{r}
el <- erdos_renyi(n = 1000, avg_deg = 5, return_edge_list = TRUE)
head(el)
```

This results in a fast way to create `igraph` objects using `igraph::graph_from_edgelist()`.

```{r}
g <- igraph::graph_from_edgelist(el)
g
```

## Related work

You can find the original research code associated with `fastRG` [here][https://github.com/raningtky/sampleRDPG]. There is also a Python translation of the original code in Python [here](https://github.com/yunjhongwu/matrix-routines/blob/master/fastRG.py). Both of these implementations are bare bones.

